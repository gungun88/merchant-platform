# 内测邀请码系统 - 快速使用指南

## 🎉 已完成功能

### ✅ 1. 数据库层
- 文件：`scripts/087_create_beta_codes_system.sql`
- 已执行完成

### ✅ 2. 后端 API
- 文件：`lib/actions/beta-codes.ts`
- 完整的 CRUD 操作
- 验证和记录功能

### ✅ 3. 管理后台页面
- 文件：`app/admin/beta-codes/page.tsx`
- 完整的可视化管理界面
- 访问地址：`/admin/beta-codes`

## 🚀 快速开始

### 第一步：访问管理后台

1. 以管理员身份登录
2. 访问：`http://localhost:3000/admin/beta-codes`
3. 您会看到内测码管理页面

### 第二步：生成内测码

#### 方式1：创建单个内测码
1. 点击右上角"创建内测码"按钮
2. 填写信息：
   - **内测码**：留空自动生成，或输入自定义（如 `BETA2024`）
   - **用途说明**：如"种子用户"、"KOL邀请"
   - **使用次数限制**：1次/5次/10次/无限制
   - **过期时间**：可选，不填则永不过期
3. 点击"创建"

#### 方式2：批量生成（推荐）
1. 点击"批量生成"按钮
2. 设置参数：
   - **生成数量**：1-100个
   - **用途说明**：所有内测码共用
   - **使用次数限制**：每个码的限制
   - **过期时间**：所有码统一过期时间
3. 点击"生成"
4. 系统会自动生成唯一的8位内测码

### 第三步：发放内测码

1. 在内测码列表中，点击内测码右侧的"复制"按钮
2. 将内测码发送给测试用户
3. 用户使用此内测码注册

### 第四步：启用内测码验证

#### 方式A：通过数据库（快速）

```sql
UPDATE system_settings
SET beta_code_required = true;
```

#### 方式B：通过系统设置页面（待实现）

在管理后台的系统设置中开启"需要内测邀请码"开关。

## 📊 功能说明

### 内测码管理页面功能

#### 1. 统计卡片
- **总内测码数**：已创建的内测码总数
- **启用中**：当前可用的内测码数量
- **总使用次数**：所有内测码被使用的总次数
- **可用内测码**：未过期、未用完、已启用的内测码数量

#### 2. 内测码列表
显示所有内测码的详细信息：
- **内测码**：8位唯一码（可复制）
- **描述**：用途说明
- **使用情况**：已使用/最大使用次数
- **过期时间**：显示过期时间或"永不过期"
- **状态**：可用/已禁用/已过期/已用完
- **创建时间**：创建的日期和时间

#### 3. 操作功能
- **👁️ 查看**：查看该内测码的使用记录（谁使用了、什么时候）
- **开关**：快速启用/禁用内测码
- **🗑️ 删除**：删除内测码（需确认）
- **📋 复制**：一键复制内测码到剪贴板
- **📥 导出**：导出所有内测码为 CSV 文件
- **🔄 刷新**：重新加载数据

#### 4. 搜索功能
在搜索框输入内测码或描述，实时过滤列表。

### 使用记录功能

点击内测码的"查看"按钮，可以看到：
- 使用该内测码的用户列表
- 用户编号、用户名、邮箱
- 使用时间

## 🔧 注册页面集成（待完成）

您还需要修改注册页面以支持内测码。请参考《内测邀请码系统实现说明.md》中的详细步骤。

关键修改点：
1. 添加内测码输入框
2. 实时验证内测码
3. 注册成功后记录使用

## 📝 使用场景

### 场景1：限量内测（推荐）
```
1. 批量生成 100 个一次性内测码
2. 设置 30 天后过期
3. 发放给种子用户
4. 监控使用情况
```

配置：
- 生成数量：100
- 使用次数：1次
- 过期时间：30天后
- 描述：2024年1月种子用户

### 场景2：KOL推广
```
1. 创建自定义内测码（如 KOL-JOHN）
2. 设置使用次数 50 次
3. 不设过期时间
4. 发给 KOL，让他分享给粉丝
```

配置：
- 自定义码：KOL-JOHN
- 使用次数：50次
- 过期时间：永不过期
- 描述：John 的推广码

### 场景3：分批内测
```
第一批：10个码，每个 5 次，7天后过期
第二批：20个码，每个 10 次，14天后过期
第三批：无限制，全面开放
```

### 场景4：VIP专属
```
创建特殊内测码，设置描述"VIP用户专属"
使用次数：无限制
过期时间：永不过期
```

## 🎯 管理建议

### 1. 命名规范
为不同用途的内测码添加清晰的描述：
- ✅ "2024-01 种子用户"
- ✅ "KOL-张三推广码"
- ✅ "技术社区发放"
- ✅ "VIP用户专属"
- ❌ "测试"
- ❌ "abc"

### 2. 使用次数设置
- **一次性（1次）**：适合限量发放，每个用户一个码
- **少量（5-10次）**：适合小范围分享
- **中量（20-50次）**：适合社区或 KOL 推广
- **无限制**：适合公开发放或 VIP 用户

### 3. 过期时间建议
- **短期测试（7天）**：快速验证功能
- **中期测试（30天）**：正常内测周期
- **长期有效（90天+）**：重要渠道或 VIP
- **永不过期**：特殊用户或持续发放

### 4. 定期检查
- 每周检查使用情况
- 及时禁用异常内测码
- 导出数据分析渠道效果
- 根据使用情况调整策略

## 🔍 监控和统计

### 查看整体情况
- 打开管理页面，查看统计卡片
- 了解总体使用情况

### 查看单个内测码效果
1. 在列表中找到内测码
2. 点击"查看"按钮
3. 查看使用记录：
   - 哪些用户使用了
   - 什么时候使用的
   - 还剩多少次

### 导出数据分析
1. 点击"导出"按钮
2. 下载 CSV 文件
3. 在 Excel 中分析：
   - 各渠道转化率
   - 过期码数量
   - 使用率统计

## ⚠️ 注意事项

### 1. 安全建议
- 不要公开分享内测码截图（容易被盗用）
- 定期检查异常使用（同一个码短时间大量使用）
- 及时禁用泄露的内测码

### 2. 使用限制
- 批量生成最多 100 个（避免滥用）
- 建议不要创建过多无限制的码
- 定期清理过期和已用完的码

### 3. 最佳实践
- 为每个渠道创建独立的内测码
- 使用描述字段标记渠道来源
- 定期导出数据备份
- 保留使用记录用于分析

## 🐛 常见问题

### Q1：内测码无效？
**检查项**：
1. 码是否已被禁用（开关关闭）
2. 是否已过期
3. 使用次数是否已达上限
4. 是否输入正确（不区分大小写）

### Q2：用户无法注册？
**检查项**：
1. 系统设置中是否启用了内测码要求
2. 注册页面是否显示内测码输入框
3. 检查浏览器控制台是否有错误

### Q3：使用记录不显示？
**检查项**：
1. 确认用户注册成功
2. 检查数据库 `beta_code_usages` 表
3. 刷新页面重试

### Q4：批量生成失败？
**检查项**：
1. 生成数量是否在 1-100 范围内
2. 网络是否正常
3. 查看浏览器控制台错误信息

## 📚 下一步

### 必须完成（启用功能）：
1. ✅ 执行数据库迁移 - 已完成
2. ✅ 创建管理后台页面 - 已完成
3. ⏳ 修改注册页面 - 待完成
4. ⏳ 启用内测码验证 - 待完成

### 可选增强：
5. 在导航菜单添加"内测码管理"入口
6. 在系统设置页面添加开关
7. 添加内测码使用统计图表
8. 添加内测码批量导入功能

需要我帮您继续完成哪一部分？建议下一步修改注册页面，这样整个系统就可以正常使用了！
