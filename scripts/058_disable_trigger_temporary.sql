-- ============================================================
-- 临时方案：禁用触发器，改为手动创建 profile
-- ============================================================
-- 由于触发器一直报错且无法获取详细日志，我们先禁用触发器
-- 改为在应用层手动创建 profile
-- ============================================================

-- 步骤 1: 禁用自动触发器
DROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;

-- 步骤 2: 保留触发器函数以便将来调试
COMMENT ON FUNCTION public.handle_new_user IS '用户注册触发器（已禁用，改为应用层处理）';

-- ============================================================
-- 执行完成！
-- ============================================================
-- 说明:
-- 1. 触发器已禁用
-- 2. 应用层将手动创建 profile、积分记录和通知
-- 3. 这是临时方案，等找到触发器错误原因后可以重新启用
-- ============================================================

SELECT '✅ 触发器已禁用，现在可以通过应用层创建用户了' as status;
